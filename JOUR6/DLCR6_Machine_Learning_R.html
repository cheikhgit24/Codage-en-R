<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DLCR6_Modèles_Machine_Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="DLCR6_Machine_Learning_R_files/libs/clipboard/clipboard.min.js"></script>
<script src="DLCR6_Machine_Learning_R_files/libs/quarto-html/quarto.js"></script>
<script src="DLCR6_Machine_Learning_R_files/libs/quarto-html/popper.min.js"></script>
<script src="DLCR6_Machine_Learning_R_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="DLCR6_Machine_Learning_R_files/libs/quarto-html/anchor.min.js"></script>
<link href="DLCR6_Machine_Learning_R_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="DLCR6_Machine_Learning_R_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="DLCR6_Machine_Learning_R_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="DLCR6_Machine_Learning_R_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="DLCR6_Machine_Learning_R_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DLCR6_Modèles_Machine_Learning</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="régression-logistique-en-r" class="level1">
<h1>Régression logistique en R</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span>  <span class="fu">read.csv</span>(<span class="st">"/Users/natachanjongwayepnga/Documents/GitHub/LeCoinStat/R_Pour_La_Datascience/Jour6/titanic.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preprocessing" class="level1">
<h1>Preprocessing</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("caret")</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  PassengerId       Survived          Pclass          Name          
 Min.   :  1.0   Min.   :0.0000   Min.   :1.000   Length:891        
 1st Qu.:223.5   1st Qu.:0.0000   1st Qu.:2.000   Class :character  
 Median :446.0   Median :0.0000   Median :3.000   Mode  :character  
 Mean   :446.0   Mean   :0.3838   Mean   :2.309                     
 3rd Qu.:668.5   3rd Qu.:1.0000   3rd Qu.:3.000                     
 Max.   :891.0   Max.   :1.0000   Max.   :3.000                     
                                                                    
     Sex                 Age            SibSp           Parch       
 Length:891         Min.   : 0.42   Min.   :0.000   Min.   :0.0000  
 Class :character   1st Qu.:20.12   1st Qu.:0.000   1st Qu.:0.0000  
 Mode  :character   Median :28.00   Median :0.000   Median :0.0000  
                    Mean   :29.70   Mean   :0.523   Mean   :0.3816  
                    3rd Qu.:38.00   3rd Qu.:1.000   3rd Qu.:0.0000  
                    Max.   :80.00   Max.   :8.000   Max.   :6.0000  
                    NA's   :177                                     
    Ticket               Fare           Cabin             Embarked        
 Length:891         Min.   :  0.00   Length:891         Length:891        
 Class :character   1st Qu.:  7.91   Class :character   Class :character  
 Mode  :character   Median : 14.45   Mode  :character   Mode  :character  
                    Mean   : 32.20                                        
                    3rd Qu.: 31.00                                        
                    Max.   :512.33                                        
                                                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># imputer les valeurs manquantes par le moyenne</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Age[<span class="fu">is.na</span>(df<span class="sc">$</span>Age)] <span class="ot">&lt;-</span> <span class="fu">mean</span>(df<span class="sc">$</span>Age, <span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   891 obs. of  12 variables:
 $ PassengerId: int  1 2 3 4 5 6 7 8 9 10 ...
 $ Survived   : int  0 1 1 1 0 0 0 0 1 1 ...
 $ Pclass     : int  3 1 3 1 3 3 1 3 3 2 ...
 $ Name       : chr  "Braund, Mr. Owen Harris" "Cumings, Mrs. John Bradley (Florence Briggs Thayer)" "Heikkinen, Miss. Laina" "Futrelle, Mrs. Jacques Heath (Lily May Peel)" ...
 $ Sex        : chr  "male" "female" "female" "female" ...
 $ Age        : num  22 38 26 35 35 ...
 $ SibSp      : int  1 1 0 1 0 0 0 3 0 1 ...
 $ Parch      : int  0 0 0 0 0 0 0 1 2 0 ...
 $ Ticket     : chr  "A/5 21171" "PC 17599" "STON/O2. 3101282" "113803" ...
 $ Fare       : num  7.25 71.28 7.92 53.1 8.05 ...
 $ Cabin      : chr  "" "C85" "" "C123" ...
 $ Embarked   : chr  "S" "C" "S" "S" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Survived <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>Survived)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>Sex)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Pclass <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>Pclass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="diviser-la-base-de-données-deux" class="level1">
<h1>Diviser la base de données deux</h1>
<p>La base d’apprentissage 70% de la base totale</p>
<p>La base test: 30%</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(caret)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span>df[, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>)]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)<span class="co"># Assurer la reproductibilité de votre </span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(df<span class="sc">$</span>Survived,<span class="at">p=</span><span class="fl">0.7</span>, <span class="at">list=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>base_train <span class="ot">&lt;-</span> df[index, ]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>base_test <span class="ot">&lt;-</span> df[<span class="sc">-</span>index,]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(base_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Survived" "Pclass"   "Sex"      "Age"      "SibSp"    "Parch"    "Fare"    </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># autre option</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df), <span class="fl">0.7</span><span class="sc">*</span><span class="fu">nrow</span>(df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="regression-logistique" class="level1">
<h1>Regression logistique</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>model_logistique <span class="ot">&lt;-</span> <span class="fu">glm</span>(Survived <span class="sc">~</span> ., <span class="at">family =</span> binomial, <span class="at">data =</span> base_train)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>model_logistique2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Survived <span class="sc">~</span> Pclass <span class="sc">+</span> Sex <span class="sc">+</span> Age <span class="sc">+</span> SibSp <span class="sc">+</span> Parch <span class="sc">+</span> Fare, <span class="at">family =</span> binomial, <span class="at">data =</span> base_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_logistique)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Survived ~ ., family = binomial, data = base_train)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  4.070865   0.559289   7.279 3.37e-13 ***
Pclass2     -1.117123   0.365626  -3.055  0.00225 ** 
Pclass3     -2.340724   0.363779  -6.434 1.24e-10 ***
Sexmale     -2.948907   0.248631 -11.861  &lt; 2e-16 ***
Age         -0.038568   0.009477  -4.070 4.70e-05 ***
SibSp       -0.336275   0.143247  -2.348  0.01890 *  
Parch       -0.194215   0.142105  -1.367  0.17172    
Fare         0.002565   0.003037   0.845  0.39833    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 832.49  on 624  degrees of freedom
Residual deviance: 528.96  on 617  degrees of freedom
AIC: 544.96

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_logistique, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model: binomial, link: logit

Response: Survived

Terms added sequentially (first to last)

       Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    
NULL                     624     832.49              
Pclass  2   85.914       622     746.57 &lt; 2.2e-16 ***
Sex     1  192.396       621     554.18 &lt; 2.2e-16 ***
Age     1   14.214       620     539.96 0.0001632 ***
SibSp   1    8.645       619     531.32 0.0032797 ** 
Parch   1    1.587       618     529.73 0.2077310    
Fare    1    0.774       617     528.96 0.3789238    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Significativité globale du modèle</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a> G2 <span class="ot">=</span> model_logistique<span class="sc">$</span>null.deviance<span class="sc">-</span>model_logistique<span class="sc">$</span>deviance</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(G2,<span class="at">df=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<section id="prédiction-sur-une-nouvelle-base" class="level2">
<h2 class="anchored" data-anchor-id="prédiction-sur-une-nouvelle-base">Prédiction sur une nouvelle base</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_logistique, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Package pour l'évaluation des modèles</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("pROC")</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_logistique, <span class="at">newdata =</span> base_test[,<span class="sc">-</span><span class="dv">1</span>],<span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(base_test<span class="sc">$</span>Survived, prediction, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">auc</span>(roc_obj))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.8254</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">main=</span><span class="st">"Courbe ROC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DLCR6_Machine_Learning_R_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>roc_resultat <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> base_test<span class="sc">$</span>Survived, <span class="at">predictor =</span> prediction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>auc_resultat <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_resultat)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>auc_resultat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.8254</code></pre>
</div>
</div>
</section>
<section id="prédiction-base-dapprentissage" class="level2">
<h2 class="anchored" data-anchor-id="prédiction-base-dapprentissage">Prédiction base d’apprentissage</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_logistique,<span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>prediction</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          3           4           6           7           8           9 
0.678676263 0.925593529 0.087662785 0.304129926 0.079812991 0.581498101 
         11          12          13          14          15          16 
0.748044491 0.870118454 0.122444490 0.018889865 0.770357549 0.705479607 
         19          20          21          22          23          25 
0.560802304 0.646395314 0.217828304 0.218720113 0.763544595 0.567732925 
         26          27          28          29          31          33 
0.276418821 0.087410137 0.417373287 0.646778724 0.413462181 0.646703018 
         37          38          40          41          42          43 
0.087410997 0.118360251 0.707390514 0.468900480 0.836167720 0.087547473 
         44          45          46          47          49          51 
0.902028771 0.734495996 0.087579070 0.065330902 0.048284540 0.050870094 
         52          53          54          55          56          60 
0.118293359 0.885090086 0.827165942 0.194626248 0.516885180 0.026790951 
         61          62          64          66          70          71 
0.114181392 0.943238163 0.063047916 0.054392880 0.053561726 0.231045680 
         72          73          77          79          82          83 
0.302279083 0.350557837 0.087547473 0.415511071 0.090062106 0.646724992 
         84          85          86          88          89          90 
0.540622559 0.910927526 0.375010157 0.087579070 0.921367124 0.106809310 
         91          92          93          94          96          99 
0.089757806 0.122390540 0.303316582 0.052477192 0.087579070 0.818645761 
        100         102         105         109         111         113 
0.171352178 0.087547473 0.035639450 0.065124991 0.364154283 0.114394487 
        114         116         117         118         119         120 
0.656492346 0.118326801 0.019494363 0.198442510 0.654060053 0.499921699 
        121         124         125         126         127         128 
0.215998631 0.849874696 0.277536575 0.120359868 0.087517606 0.106587272 
        129         130         131         132         133         134 
0.527859803 0.050381174 0.077897411 0.122169171 0.405729465 0.827165942 
        135         138         139         140         141         143 
0.283731387 0.376330934 0.140370325 0.598555469 0.558573284 0.624544262 
        144         145         146         149         150         151 
0.126281086 0.340762662 0.237905728 0.151273383 0.170556877 0.126748671 
        152         154         156         157         159         160 
0.955079576 0.041805779 0.292802789 0.756370896 0.087704681 0.005145573 
        161         162         163         164         166         168 
0.044417555 0.810215428 0.099607206 0.135613966 0.129919933 0.259801113 
        169         171         172         173         174         175 
0.510750605 0.241443835 0.055322908 0.766676179 0.118326801 0.277052159 
        176         177         178         180         181         184 
0.081410268 0.029257349 0.901685822 0.068675270 0.089843064 0.309924167 
        185         186         190         191         192         193 
0.776246985 0.526164854 0.069981849 0.852318542 0.333006470 0.664009863 
        194         195         196         197         198         199 
0.360158468 0.920192346 0.901117211 0.087517606 0.046918530 0.646703018 
        203         204         206         207         208         209 
0.074922550 0.049496684 0.815420547 0.060167434 0.102169104 0.756378789 
        213         215         216         217         220         221 
0.114186788 0.064127611 0.944249178 0.670208218 0.245033241 0.140009645 
        223         224         225         226         227         228 
0.040500602 0.087547473 0.389579453 0.114732700 0.331583843 0.120170318 
        231         232         233         235         236         237 
0.930784063 0.089700198 0.096558548 0.290311639 0.646585812 0.123277165 
        238         239         241         242         243         244 
0.910852752 0.331583843 0.570893459 0.571550404 0.252237993 0.114154365 
        245         247         248         249         250         251 
0.086488874 0.686945685 0.842489068 0.331642556 0.087269698 0.087415252 
        252         253         254         255         256         257 
0.526975984 0.231266606 0.064718950 0.453201889 0.565210808 0.958055260 
        258         259         260         261         264         266 
0.958340373 0.982621156 0.710497840 0.087517606 0.396333066 0.204779003 
        267         269         270         271         274         275 
0.036495656 0.884248167 0.955589133 0.514002610 0.395773967 0.646703018 
        277         278         280         281         284         285 
0.503612824 0.242209279 0.475445351 0.023990409 0.126649417 0.510798671 
        286         287         288         289         291         292 
0.078038772 0.086950985 0.114354428 0.170556877 0.963396559 0.962144532 
        297         300         301         304         305         306 
0.108459303 0.929763964 0.646703018 0.862945912 0.087579070 0.679278251 
        309         310         311         312         313         314 
0.193577291 0.955204989 0.966382365 0.952055615 0.815652113 0.092925789 
        315         316         317         318         319         321 
0.107478388 0.678636663 0.853023466 0.114869470 0.948322066 0.114186788 
        323         324         325         326         327         328 
0.861567659 0.838773440 0.005145573 0.953923293 0.027775703 0.831826838 
        330         331         332         333         335         337 
0.967961735 0.492945713 0.363594330 0.463998686 0.949402327 0.459592841 
        338         339         340         341         342         343 
0.944513402 0.050513245 0.372253767 0.369093361 0.918527070 0.260815997 
        344         345         346         347         348         349 
0.283731387 0.205825113 0.887099258 0.809128536 0.571927195 0.138932980 
        350         351         352         354         355         356 
0.056443790 0.110841595 0.516564946 0.077730321 0.087410137 0.093273172 
        357         358         359         360         361         362 
0.959659085 0.820758350 0.646778724 0.646778724 0.021815688 0.201198552 
        363         364         365         366         367         368 
0.459447149 0.072388248 0.065330902 0.086493940 0.833896422 0.646397776 
        371         374         375         379         381         382 
0.490919142 0.650519323 0.614305840 0.121336155 0.954110578 0.793067770 
        383         384         385         386         387         388 
0.080718786 0.925398998 0.087547473 0.377333030 0.038908633 0.831826838 
        389         391         393         394         395         396 
0.087513346 0.335495968 0.049694050 0.958434992 0.612755052 0.114328455 
        399         401         402         403         407         408 
0.298321650 0.062820243 0.099670480 0.647743116 0.040470712 0.355884742 
        409         411         412         413         415         416 
0.118286672 0.087547473 0.087335144 0.936592574 0.052379518 0.646878794 
        417         418         419         420         421         422 
0.767685649 0.870391819 0.246221319 0.734576821 0.087547473 0.118275518 
        423         424         425         426         427         428 
0.089721142 0.539088976 0.083812230 0.087415252 0.832610365 0.907847377 
        430         431         432         433         434         437 
0.080742578 0.527508151 0.571927195 0.743509047 0.135152387 0.486851378 
        438         440         442         444         445         448 
0.694448737 0.237968790 0.122844650 0.870701470 0.087591880 0.469720837 
        449         450         451         452         454         456 
0.672591130 0.308879941 0.115357113 0.066033925 0.294084714 0.089725499 
        460         461         462         463         464         466 
0.087517606 0.340465825 0.075199293 0.356175571 0.140264535 0.064993043 
        467         469         470         471         473         474 
0.242209279 0.087512486 0.707617841 0.087415252 0.736423168 0.891101926 
        475         476         477         478         479         480 
0.712359799 0.527443537 0.169539001 0.065654108 0.114257057 0.816123991 
        481         482         483         484         485         486 
0.028877259 0.242209279 0.042026219 0.337364232 0.513764874 0.365163189 
        487         488         489         490         491         494 
0.931854470 0.261377443 0.086656196 0.113488807 0.066033925 0.184009576 
        496         497         499         500         501         502 
0.088901356 0.864437186 0.941068657 0.106747128 0.135613966 0.719117225 
        503         505         506         510         511         512 
0.646632227 0.975292354 0.591641664 0.111388057 0.089694963 0.087579070 
        513         514         515         516         518         519 
0.450395074 0.858666154 0.106673785 0.353545586 0.090935374 0.785109803 
        521         522         523         525         527         528 
0.959051268 0.114354428 0.087410137 0.087410997 0.741209465 0.633049975 
        531         532         533         534         535         536 
0.917798076 0.087410997 0.084217743 0.563066199 0.644583496 0.913935259 
        538         539         541         542         546         548 
0.960333474 0.088910019 0.922447771 0.432835852 0.217597902 0.248794604 
        549         550         551         553         554         555 
0.048829298 0.323015909 0.589586697 0.087533829 0.114180303 0.711274691 
        557         558         560         561         563         565 
0.879200673 0.636466462 0.512507201 0.087517606 0.261063302 0.646878794 
        567         568         569         570         571         572 
0.126605679 0.472243249 0.087410997 0.080705313 0.086316740 0.815512263 
        574         575         576         577         582         583 
0.646703018 0.140009645 0.128490507 0.842343119 0.910569150 0.118035973 
        585         586         587         589         590         592 
0.087714942 0.960550708 0.145617340 0.114394487 0.087579070 0.873225048 
        594         595         596         598         599         600 
0.553827853 0.155542065 0.044117844 0.042753711 0.087410137 0.277249188 
        601         602         603         604         606         607 
0.773921644 0.087547473 0.521302871 0.052395433 0.051975273 0.086624900 
        608         609         610         611         613         614 
0.539627384 0.815654305 0.948910251 0.268714938 0.571550404 0.087517606 
        615         617         618         619         620         621 
0.072560654 0.046369241 0.606443401 0.884190782 0.274679778 0.071803539 
        623         624         625         627         628         630 
0.077254728 0.118307859 0.120531731 0.103226758 0.969553854 0.087514186 
        631         633         635         639         641         642 
0.131638193 0.491501309 0.514328354 0.327296681 0.122390540 0.965208327 
        644         645         646         647         648         649 
0.098029920 0.707617841 0.295504505 0.126605679 0.279526854 0.087476651 
        652         653         655         656         660         661 
0.893241672 0.118462873 0.741394026 0.197048705 0.229187855 0.243014584 
        662         664         668         669         670         672 
0.060485408 0.069915108 0.087522726 0.054343740 0.938342274 0.431296519 
        673         674         676         677         678         679 
0.064887882 0.239133464 0.130896936 0.104983489 0.742911409 0.212559588 
        681         682         683         684         685         686 
0.646930055 0.568910757 0.122768671 0.023933790 0.060669917 0.171159261 
        687         688         690         694         695         696 
0.039307181 0.127252276 0.978961816 0.102989636 0.245263276 0.122810043 
        697         698         699         700         701         702 
0.052395433 0.646693232 0.266200851 0.056305649 0.974014945 0.459959319 
        704         706         708         710         711         713 
0.103112126 0.192687723 0.394010901 0.054392880 0.963462515 0.282474183 
        714         715         718         719         721         722 
0.090058596 0.122671963 0.874278690 0.089117995 0.931677946 0.100416325 
        723         724         725         726         727         730 
0.218720113 0.131218150 0.470168084 0.122613386 0.698829649 0.610636363 
        731         732         734         735         736         737 
0.970528415 0.168705396 0.299665548 0.299665548 0.093074040 0.278505746 
        738         741         742         743         744         746 
0.747639644 0.513361906 0.401182402 0.946489264 0.080218338 0.127171174 
        751         753         754         755         757         758 
0.911167017 0.078193456 0.110506059 0.632852648 0.092904173 0.340762662 
        760         761         762         763         764         765 
0.953468022 0.088910019 0.058316409 0.122218469 0.905977126 0.139924743 
        766         767         768         769         770         771 
0.877348469 0.519510547 0.639614098 0.066698713 0.080802087 0.107164613 
        773         774         776         777         778         779 
0.686172864 0.087410137 0.130889642 0.087517606 0.827683174 0.087515046 
        780         781         782         783         784         786 
0.940489379 0.776831504 0.961768769 0.520095176 0.046143072 0.102995560 
        788         790         791         792         794         795 
0.047791844 0.389586825 0.087517606 0.366892253 0.513807713 0.103148682 
        796         797         798         799         800         802 
0.187554208 0.904437058 0.635711618 0.086489726 0.526112601 0.784986169 
        803         804         807         809         810         811 
0.569735618 0.196654612 0.405596505 0.187554208 0.930734593 0.099633087 
        812         813         814         815         816         819 
0.065315182 0.211131154 0.461430333 0.085142037 0.494129825 0.054133240 
        820         821         822         823         826         829 
0.050683300 0.855033093 0.096399308 0.414927639 0.087353892 0.087517606 
        830         831         833         835         837         838 
0.868163686 0.701073506 0.087410997 0.131050193 0.118524275 0.087579070 
        840         841         842         843         844         845 
0.513169686 0.122410046 0.357708041 0.952271778 0.073586701 0.135613966 
        847         848         850         852         853         856 
0.005145573 0.072534045 0.943623710 0.017075839 0.709228409 0.703846090 
        857         860         861         865         866         867 
0.902705030 0.087410997 0.031176251 0.291634450 0.796930835 0.833643033 
        869         871         872         875         877         880 
0.087876697 0.099634996 0.865583443 0.831894248 0.122940248 0.873262002 
        883         885         887         888         889         890 
0.712716602 0.102948179 0.268319881 0.968170431 0.480045634 0.548875541 
        891 
0.080685488 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(base_train<span class="sc">$</span>Survived, prediction, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">auc</span>(roc_obj))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.8683</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">main=</span><span class="st">"Courbe ROC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DLCR6_Machine_Learning_R_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>roc_resultat <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> base_train<span class="sc">$</span>Survived, <span class="at">predictor =</span> prediction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1
Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>auc_resultat <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_resultat)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>auc_resultat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.8683</code></pre>
</div>
</div>
</section>
</section>
<section id="forêts-aléatoires" class="level1">
<h1>Forêts aléatoires</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("randomForest")</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'randomForest'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    margin</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>model_rf <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Survived <span class="sc">~</span> ., <span class="at">data=</span>base_train, <span class="at">importance=</span><span class="cn">TRUE</span>,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ntree=</span><span class="dv">500</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>model_rf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = Survived ~ ., data = base_train, importance = TRUE,      ntree = 500) 
               Type of random forest: classification
                     Number of trees: 500
No. of variables tried at each split: 2

        OOB estimate of  error rate: 16.64%
Confusion matrix:
    0   1 class.error
0 344  41   0.1064935
1  63 177   0.2625000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importance des variables</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(model_rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               0         1
Pclass 22.715321 22.715321
Sex    73.434662 73.434662
Age    18.601066 18.601066
SibSp  14.215484 14.215484
Parch   8.846552  8.846552
Fare   20.543189 20.543189</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(model_rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DLCR6_Machine_Learning_R_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DLCR6_Machine_Learning_R_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>prediction_train <span class="ot">&lt;-</span>  <span class="fu">predict</span>(model_rf, <span class="at">type =</span> <span class="st">"prob"</span>)[,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>prediction_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_rf, <span class="at">newdata =</span> base_test, <span class="at">type =</span> <span class="st">"prob"</span>)[,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(base_train<span class="sc">$</span>Survived, prediction_train, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">auc</span>(roc_obj))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.8756</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">main=</span><span class="st">"Courbe ROC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DLCR6_Machine_Learning_R_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(base_test<span class="sc">$</span>Survived, prediction_test, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">auc</span>(roc_obj))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.8615</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">main=</span><span class="st">"Courbe ROC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DLCR6_Machine_Learning_R_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="optimisation-des-paramètres-de-la-forêt-aléatoire" class="level2">
<h2 class="anchored" data-anchor-id="optimisation-des-paramètres-de-la-forêt-aléatoire">Optimisation des paramètres de la forêt aléatoire</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Définition des paramètres de validation croisée</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"cv"</span>, <span class="at">number=</span><span class="dv">5</span>, <span class="at">search=</span><span class="st">"grid"</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Grid de paramètres à tester</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>tunegrid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">.mtry=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Entraînement du modèle avec validation croisée et recherche des meilleurs hyperparamètres</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">train</span>(Survived <span class="sc">~</span> ., <span class="at">data=</span>base_train, <span class="at">method=</span><span class="st">"rf"</span>, <span class="at">trControl=</span>control, <span class="at">tuneGrid=</span>tunegrid, <span class="at">ntree=</span><span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Meilleurs paramètres trouvés</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rf_model<span class="sc">$</span>bestTune)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  mtry
3    3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Entraînement direct avec randomForest pour accès à l'erreur OOB</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>rf_model_direct <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Survived <span class="sc">~</span> ., <span class="at">data=</span>base_train, <span class="at">mtry=</span>rf_model<span class="sc">$</span>bestTune<span class="sc">$</span>mtry, <span class="at">ntree=</span><span class="dv">500</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rf_model_direct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DLCR6_Machine_Learning_R_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importance des variables</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>importance <span class="ot">&lt;-</span> <span class="fu">varImp</span>(rf_model, <span class="at">scale=</span><span class="cn">FALSE</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(importance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rf variable importance

        Overall
Sexmale  81.531
Fare     63.682
Age      50.348
Pclass3  20.795
SibSp    12.311
Parch    10.290
Pclass2   4.192</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prédiction sur l'ensemble de test</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, <span class="at">newdata=</span>base_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de l'AUC et tracé de la courbe ROC</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>prob_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, <span class="at">newdata=</span>base_test, <span class="at">type=</span><span class="st">"prob"</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(base_test<span class="sc">$</span>Survived, prob_predictions[,<span class="dv">2</span>], <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">auc</span>(roc_obj))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.8577</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">main=</span><span class="st">"Courbe ROC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DLCR6_Machine_Learning_R_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>